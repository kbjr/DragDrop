/**
 * DragDrop.js
 *
 * A JavaScript micro-framework for adding drag-and-drop functionality
 * to elements for advanced UI development.
 *
 * @author     James Brumond
 * @version    0.1.1-dev
 * @copyright  Copyright 2011 James Brumond
 * @license    Dual licensed under MIT and GPL
 */
(function(){var a=!0,b=function(){var a,b=document.createElement("div");a="ontouchstart"in b,b=null;return a}(),c="drag",d=new function(){var g=this,l=function(){return b?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"}}(),m=[],n=function(a,b){for(var c=0,d=m.length;c<d;c++)if(m[c].elem===a&&m[c].anchor===b)return[c,m[c]];return!1};this.bind=function(b,e){if(typeof b=="object"&&b){e=e||b;if(!n(b,e)){var g={elem:b,anchor:e,dragging:!1,event:null,shouldUnbind:!1};g.event=k.bind(e,l.start,function(a){if(window.event&&a.button===1||a.button===0){g.dragging=!0,j(b,c);var m=f(b,"left"),n=f(b,"top"),o=[];o.push(k.bind(document,l.move,function(c){var d=c.clientX-a.clientX,e=c.clientY-a.clientY;b.style.left=m+d+"px",b.style.top=n+e+"px";return h(c)})),o.push(k.bind(document,l.end,function(a){for(var f=0,j=o.length;f<j;f++)k.unbind(o[f]);g.dragging=!1,i(b,c),g.shouldUnbind&&d.unbind(b,e);return h(a)})),document.body.focus(),o.push(k.bind(document,"selectstart",!1)),o.push(k.bind(e,"dragstart",!1));return h(a)}}),m.push(g)}}else if(a){var o=typeof b;o=o==="object"?"NULL":'"'+o+'"';throw new TypeError('DragDrop.bind: argument 1 expects type "object", '+o+" given.")}},this.unbind=function(b,c){if(typeof b=="object"&&b){var d=n(b,c),f;d&&(f=d[0],d=d[1],d.dragging?d.shouldUnbind=!0:(k.unbind(d.event),e(m,f)))}else if(a){var g=typeof b;g=g==="object"?"NULL":'"'+g+'"';throw new TypeError('DragDrop.unbind: argument 1 expects type "object", '+g+" given.")}}},e=function(a,b,c){var d=a.slice((c||b)+1||a.length);a.length=b<0?a.length+b:b;return a.push.apply(a,d)},f=function(a,b){var c=parseFloat(g(a,b));return isNaN(c)?0:c},g=function(a,b){if(a.currentStyle)return a.currentStyle[b];if(window.getComputedStyle)return document.defaultView.getComputedStyle(a,null).getPropertyValue(b);if(a.style)return a.style[b]},h=function(a){a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.returnValue=!1;return!1},i=function(a,b){var c=new RegExp("(^|\\s)+"+b+"(\\s|$)+");a.className.replace(c," ")},j=function(a,b){i(a,b),a.className+=" "+b},k=function(){var b=function(){return document.addEventListener?function(a,b,c){a.addEventListener(b,c,!1)}:document.attachEvent?function(a,b,c){a.attachEvent("on"+b,c)}:function(){if(a)throw new Error("DragDrop->Events->bindEvent: Could not bind event. No event binder found.")}}(),c=function(){return document.removeEventListener?function(a,b,c){a.removeEventListener(b,c,!1)}:document.detachEvent?function(a,b,c){a.detachEvent("on"+b,c)}:function(){if(a)throw new Error("DragDrop->Events->unbindEvent: Could not unbind event. No event unbinder found.")}}();return{bind:function(a,d,e){var f=e===!1?function(a){return h(a)}:e;e=function(b){return f.call(a,b||window.event)},b(a,d,e);var g=function(){c(a,d,e)};g.unbind=function(){g()};return g},unbind:function(a){a()}}}();window.DragDrop=d})()
